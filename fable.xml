<fable>
  <config font-family="Poppins" />

  <!-- Variáveis do sistema -->
  <property name="pontos" default="0" />
  <property name="vida" default="100" />
  <property name="nivel" default="1" />
  <property name="dinheiro" default="50" />
  <property name="tem_chave" default="false" />
  <property name="fase_atual" default="1" />

  <!-- Página inicial - Demonstra set() -->
  <page id="inicio" bg_color="#2c3e50">
    <agent
      id="titulo"
      x="300"
      y="50"
      text="🎮 Teste de Funções FableML"
      color="#ffffff"
      font-size="24"
    />

    <agent
      id="stats"
      x="50"
      y="100"
      text="Pontos: $pontos | Vida: $vida | Nível: $nivel | Dinheiro: $dinheiro"
      color="#ffffff"
      font-size="14"
    />

    <!-- Testes com set() -->
    <agent
      id="ganhar_pontos"
      x="100"
      y="200"
      text="+ 10 Pontos"
      color="#27ae60"
      animation="hover-grow"
      on_click="set(pontos, $pontos + 10)"
    />

    <agent
      id="ganhar_dinheiro"
      x="250"
      y="200"
      text="+ 25 Moedas"
      color="#f39c12"
      animation="hover-grow"
      on_click="set(dinheiro, $dinheiro + 25)"
    />

    <agent
      id="subir_nivel"
      x="400"
      y="200"
      text="Level Up!"
      color="#9b59b6"
      animation="hover-grow"
      on_click="set(nivel, $nivel + 1); set(vida, 100); set(pontos, $pontos + 50)"
    />

    <!-- Botão para página de testes setIf() -->
    <agent
      id="ir_setif"
      x="300"
      y="300"
      text="🔀 Testar setIf()"
      color="#3498db"
      animation="hover-grow"
      on_click="goToPage(teste_setif)"
    />
  </page>

  <!-- Página de testes setIf() -->
  <page id="teste_setif" bg_color="#34495e">
    <agent
      id="titulo2"
      x="300"
      y="50"
      text="🔀 Testes com setIf()"
      color="#ffffff"
      font-size="24"
    />

    <agent
      id="stats2"
      x="50"
      y="100"
      text="Pontos: $pontos | Vida: $vida | Dinheiro: $dinheiro | Chave: $tem_chave"
      color="#ffffff"
      font-size="14"
    />

    <!-- Testes condicionais -->
    <agent
      id="comprar_pocao"
      x="150"
      y="200"
      text="🧪 Comprar Poção (20 moedas)"
      color="#e74c3c"
      animation="hover-grow"
      on_click="setIf($dinheiro >= 20, dinheiro, $dinheiro - 20);
                     setIf($dinheiro >= 20, vida, $vida + 30)"
    />

    <agent
      id="comprar_chave"
      x="350"
      y="200"
      text="🗝️ Comprar Chave (50 moedas)"
      color="#f1c40f"
      animation="hover-grow"
      on_click="setIf($dinheiro >= 50, dinheiro, $dinheiro - 50);
                     setIf($dinheiro >= 50, tem_chave, true)"
    />

    <agent
      id="area_secreta"
      x="250"
      y="300"
      text="🚪 Área Secreta (precisa da chave)"
      color="#95a5a6"
      animation="hover-grow"
      on_click="setIf($tem_chave = true, fase_atual, 2);
                     setIf($tem_chave = true, goToPage, area_secreta)"
    />

    <agent
      id="voltar_inicio"
      x="100"
      y="400"
      text="⬅️ Voltar"
      color="#7f8c8d"
      animation="hover-grow"
      on_click="goToPage(inicio)"
    />

    <!-- Mostra mensagem se não tem chave -->
    <fab-if when="not $tem_chave">
      <agent
        id="sem_chave"
        x="450"
        y="300"
        text="❌ Precisa da chave!"
        color="#e74c3c"
        font-size="12"
      />
    </fab-if>
  </page>

  <!-- Área secreta - só acessível com chave -->
  <page id="area_secreta" bg_color="#8e44ad">
    <agent
      id="titulo3"
      x="300"
      y="50"
      text="🏆 Área Secreta Desbloqueada!"
      color="#ffffff"
      font-size="24"
    />

    <agent
      id="tesouro"
      x="300"
      y="200"
      text="💎 Você encontrou um tesouro!"
      color="#f1c40f"
      font-size="18"
      animation="bounce-in"
    />

    <agent
      id="pegar_tesouro"
      x="300"
      y="300"
      text="💰 Pegar Tesouro"
      color="#27ae60"
      animation="hover-grow"
      on_click="set(dinheiro, $dinheiro + 100); set(pontos, $pontos + 500)"
    />

    <agent
      id="voltar_setif"
      x="300"
      y="400"
      text="⬅️ Voltar aos Testes"
      color="#3498db"
      animation="hover-grow"
      on_click="goToPage(teste_setif)"
    />
  </page>
</fable>
